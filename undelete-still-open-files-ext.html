<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1, minimum-scale=1, maximum-scale=1">
<meta name="renderer" content="webkit">
<meta name="google" value="notranslate">
<meta name="robots" content="index,follow">


<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bard&#39;s Gallery">
<meta name="twitter:description" content="Into Something Rich and Strange">
<meta name="twitter:image:src" content="https://bergwolf.me/images/avatar.png">

<meta property="og:url" content="https://bergwolf.me">
<meta property="og:title" content="Bard&#39;s Gallery">
<meta property="og:description" content="Into Something Rich and Strange">
<meta property="og:site_name" content="Bard&#39;s Gallery">
<meta property="og:image" content="https://bergwolf.me/images/avatar.png">
<meta property="og:type" content="website">
<meta name="robots" content="noodp">

<meta itemprop="name" content="Bard&#39;s Gallery">
<meta itemprop="description" content="Into Something Rich and Strange">
<meta itemprop="image" content="https://bergwolf.me/images/avatar.png">

<link rel="canonical" href="https://bergwolf.me">

<link rel="shortcut icon" href="/favicon.png">
<link rel="apple-itouch-icon" href="/favicon.png">
<link rel="stylesheet" href="/bundle/index.css">
<script type="text/javascript">
    var timeSinceLang = {
        year: '年前',
        month: '个月前',
        day: '天前',
        hour: '小时前',
        minute: '分钟前',
        second: '秒前'
    };
    var root = '';
</script>


        <meta name="keywords" content="KERNEL,">
        <meta name="description" content="Undelete Still Open Files on ext2/3/4">
        <meta name="author" content="Bergwolf">
        <title>Undelete Still Open Files on ext2/3/4</title>
    </head>
    <body>
        <article class="container">
            <header class="header-wrap">
  <a class="index" href="/">
    <img class="logo" src="/images/avatar.png" />
    Bard&#39;s Gallery
  </a>
  <ul class="menu">
      <li class="menu-item"><a href="/archive.html">归档</a></li>
      <li class="menu-item"><a href="/tag.html">标签</a></li>
      <li class="menu-item"><a href="/atom.xml">订阅</a></li>
  </ul>
</header>

            <article class="main article">
                <h1 class="title">Undelete Still Open Files on ext2/3/4</h1>
                <section class="info">
                    <span class="avatar" style="background-image: url(/images/avatar.png);"></span>
                    <a class="name" href="/about.me.html">Bergwolf</a>
                    
                    <span class="date" data-time="1224418740"><span class="from"></span></span>
                    
                    <span class="tags"><a class="tag" href="/tag/KERNEL/index.html">KERNEL</a></span>
                </section>
                <article class="content"><p>As mentioned by Ted on linux-ext4 mailing list, there are some ways to get your files back if it is still open:</p>

<p>Some background:<br />
On ext3/4, once deleted, the inode will be put to orphaned inode list. On recovery,on recovery this orphan list is traversed and iput will be called on each of the inodes to mark them as free.</p>

<p>So, theoretically, we have out first solution:<br />
1. provoke a crash and manually remove the inode from the orphan list, then mount the partition as ext3.</p>

<p>But another simple solution exists:<br />
2. kill -STOP the process that owns the file, copy it via &ldquo;cat /proc/$pid/fd/$fd &gt; rescue-file&rdquo;. and then kill -9 the process if you don&rsquo;t want it to make any further changes.</p>
</article>
                <section class="author">
                    <div class="avatar" style="background-image: url(/images/avatar.png);"></div>
                    <a class="name" href="/about.me.html">Bergwolf</a>
                    <div class="intro">Everyday citizen, A gear</div>
                </section>
                <section class="recommend">
                    
                    <section class="nav prev more">
                        <div class="head">上篇文章</div>
                        <a class="link" href="/ngfs.html">NGFS From ext4 to btrfs</a>
                    </section>
                    
                    
                    <section class="nav next more">
                        <div class="head">下篇文章</div>
                        <a class="link" href="/gnome-asia-summit.html">Gnome Asia Summit 2008</a>
                    </section>
                    
                </section>
                


            </article>
        </article>
        <footer class="footer">
    <span class="copyright">
        Bard&#39;s Gallery ©
        <script type="text/javascript">
            document.write(new Date().getFullYear());
        </script>
    </span>
    <span class="publish">Powered by <a href="http://www.chole.io/" target="_blank">Ink</a></span>
</footer>

        <script src="/bundle/index.js"></script>
    </body>
</html>
